
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PyTorch Quantization Framework For OCP MX Datatypes.">
      
      
      
      
        <link rel="prev" href="../mx_quantization_utils/">
      
      
        <link rel="next" href="../ops/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>torchmx.mx_tensor - torchmx Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#torchmxmx_tensor" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="torchmx Documentation" class="md-header__button md-logo" aria-label="torchmx Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            torchmx Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              torchmx.mx_tensor
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="cyan"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m3.55 19.09 1.41 1.41 1.8-1.79-1.42-1.42M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6c0-3.32-2.69-6-6-6m8 7h3v-2h-3m-2.76 7.71 1.8 1.79 1.41-1.41-1.79-1.8M20.45 5l-1.41-1.4-1.8 1.79 1.42 1.42M13 1h-2v3h2M6.76 5.39 4.96 3.6 3.55 5l1.79 1.81zM1 13h3v-2H1m12 9h-2v3h2"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/rain-neuromorphics/torchmx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    torchmx
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/mx_matmul/" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../results/llama3.1%20results/" class="md-tabs__link">
          
  
  
  Results

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../user_docs/User%20API%20Home/" class="md-tabs__link">
          
  
  
  User API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../Developer%20API%20Home/" class="md-tabs__link">
          
  
  
  Developer API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="torchmx Documentation" class="md-nav__button md-logo" aria-label="torchmx Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    torchmx Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/rain-neuromorphics/torchmx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    torchmx
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mx_matmul/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MX Matmul
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/quantize_linear/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantize Linear
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/quantize_llama/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantize Llama
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Results
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Results
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../results/llama3.1%20results/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Llama3.1 Results
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            User API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_docs/User%20API%20Home/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User API Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_docs/mx_tensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.mx_tensor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_docs/quant_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.quant_api
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_docs/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_docs/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_docs/dtypes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.dtypes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_docs/env_variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.env_variables
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Developer API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Developer API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Developer%20API%20Home/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer API Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_float_cast/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.custom_float_cast
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mx_quantization_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.mx_quantization_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    torchmx.mx_tensor
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    torchmx.mx_tensor
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quantize_mx" class="md-nav__link">
    <span class="md-ellipsis">
      quantize_mx
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_" class="md-nav__link">
    <span class="md-ellipsis">
      _
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dequantize_mx" class="md-nav__link">
    <span class="md-ellipsis">
      dequantize_mx
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#__1" class="md-nav__link">
    <span class="md-ellipsis">
      _
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tomxconstrfunc-objects" class="md-nav__link">
    <span class="md-ellipsis">
      ToMXConstrFunc Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToMXConstrFunc Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frommxconstrfunc-objects" class="md-nav__link">
    <span class="md-ellipsis">
      FromMXConstrFunc Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FromMXConstrFunc Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forward_1" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#noopfwtomxbw-objects" class="md-nav__link">
    <span class="md-ellipsis">
      NoopFwToMXBw Objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mxtensor-objects" class="md-nav__link">
    <span class="md-ellipsis">
      MXTensor Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MXTensor Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__new__" class="md-nav__link">
    <span class="md-ellipsis">
      __new__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_dtype" class="md-nav__link">
    <span class="md-ellipsis">
      to_dtype
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_mx" class="md-nav__link">
    <span class="md-ellipsis">
      to_mx
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.ops
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quant_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.quant_api
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dtypes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.dtypes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../env_variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchmx.env_variables
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quantize_mx" class="md-nav__link">
    <span class="md-ellipsis">
      quantize_mx
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_" class="md-nav__link">
    <span class="md-ellipsis">
      _
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dequantize_mx" class="md-nav__link">
    <span class="md-ellipsis">
      dequantize_mx
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#__1" class="md-nav__link">
    <span class="md-ellipsis">
      _
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tomxconstrfunc-objects" class="md-nav__link">
    <span class="md-ellipsis">
      ToMXConstrFunc Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToMXConstrFunc Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frommxconstrfunc-objects" class="md-nav__link">
    <span class="md-ellipsis">
      FromMXConstrFunc Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FromMXConstrFunc Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forward_1" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#noopfwtomxbw-objects" class="md-nav__link">
    <span class="md-ellipsis">
      NoopFwToMXBw Objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mxtensor-objects" class="md-nav__link">
    <span class="md-ellipsis">
      MXTensor Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MXTensor Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__new__" class="md-nav__link">
    <span class="md-ellipsis">
      __new__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_dtype" class="md-nav__link">
    <span class="md-ellipsis">
      to_dtype
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_mx" class="md-nav__link">
    <span class="md-ellipsis">
      to_mx
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<p><a id="torchmx.mx_tensor"></a></p>
<h1 id="torchmxmx_tensor">torchmx.mx_tensor</h1>
<p>Defines the tensor subclasses to represent the <a href="https://www.opencompute.org/documents/ocp-microscaling-formats-mx-v1-0-spec-final-pdf">OCP MX-Format spec</a></p>
<p>Exponent E8M0 encoding details (OCP spec section 5.4.1):</p>
<ul>
<li>bias: 127</li>
<li>supported exponent range: -127 to 127</li>
<li>infinities: N/A</li>
<li>NaN: 11111111</li>
<li>Zeros: N/A</li>
</ul>
<p><a id="torchmx.mx_tensor.quantize_mx"></a></p>
<h4 id="quantize_mx">quantize_mx</h4>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L37">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">custom_op</span><span class="p">(</span><span class="s2">&quot;torchmx::quantize_mx&quot;</span><span class="p">,</span> <span class="n">mutates_args</span><span class="o">=</span><span class="p">())</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">quantize_mx</span><span class="p">(</span><span class="n">data_hp</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">elem_dtype_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                <span class="n">block_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<p>Takes a high precision tensor and converts to MX scale and raw data, in
naive layout (scale and raw data are separate tensors). The function for now only
supports quantization along the last dimension of the input tensor. For example,
if the input tensor has shape (N, C, H, W) the output will be:
- data_lp (torch.uint8) with shape (N, C, H, W)
- scale (torch.uint8) with shape (N, C, H, W // block_size)</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>data_hp</code> <em>torch.Tensor</em> - high precision data tensor (dtype=torch.bfloat16)</li>
<li><code>elem_dtype_name</code> <em>str</em> - target element dtype as a string to comply with torch.library.infer_schema</li>
<li><code>block_size</code> <em>int</em> - block size</li>
</ul>
<p><strong>Returns</strong>:</p>
<p>Tuple[torch.Tensor, torch.Tensor]: scale(biased), low precision data as tensors</p>
<p><a id="torchmx.mx_tensor._"></a></p>
<h4 id="_">_</h4>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L100">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="nd">@quantize_mx</span><span class="o">.</span><span class="n">register_fake</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">_</span><span class="p">(</span><span class="n">data_hp</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">elem_dtype_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>      <span class="n">block_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<p>Fake quantize_mx implementation.</p>
<p>This adds a “FakeTensor kernel” (aka “meta kernel”) to the operator. Given some
FakeTensors inputs (dummy Tensors that don't have storage), this function returns
dummy Tensors with the correct Tensor metadata(shape/strides/dtype/device). This is
used by torch.compile to infer the shape and other metadata of the output tensors.</p>
<p>Reference: https://pytorch.org/tutorials/advanced/python_custom_ops.html#python-custom-ops-tutorial</p>
<p><a id="torchmx.mx_tensor.dequantize_mx"></a></p>
<h4 id="dequantize_mx">dequantize_mx</h4>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L124">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span>
<span class="normal"><a href="#__codelineno-2-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">custom_op</span><span class="p">(</span><span class="s2">&quot;torchmx::dequantize_mx&quot;</span><span class="p">,</span> <span class="n">mutates_args</span><span class="o">=</span><span class="p">())</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">dequantize_mx</span><span class="p">(</span><span class="n">data_lp</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">shared_exp_e8m0</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>                  <span class="n">elem_dtype_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">block_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a>                  <span class="n">target_dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">block_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>
<p>Takes the low precision data and scale of MXTensor and converts to high precision</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>data_lp</code> <em>torch.Tensor</em> - low precision data tensor</li>
<li><code>shared_exp_e8m0</code> <em>torch.Tensor</em> - biased exponent of the shared MX scale as torch.uint8</li>
<li><code>elem_dtype_name</code> <em>str</em> - target element dtype's name as a string to comply with torch.library.infer_schema</li>
<li><code>block_size</code> <em>int</em> - block size</li>
<li><code>target_dtype</code> <em>torch.dtype</em> - target dtype</li>
<li><code>block_dim</code> <em>int</em> - block dimension</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>torch.Tensor</code> - high precision data tensor in target_dtype converted from MX</li>
</ul>
<p><a id="torchmx.mx_tensor._"></a></p>
<h4 id="__1">_</h4>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L168">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="nd">@dequantize_mx</span><span class="o">.</span><span class="n">register_fake</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">_</span><span class="p">(</span><span class="n">data_lp</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">shared_exp_e8m0</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a>      <span class="n">elem_dtype_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">block_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">target_dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>      <span class="n">block_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>
<p>Fake dequantize_mx implementation.</p>
<p>This adds a “FakeTensor kernel” (aka “meta kernel”) to the operator. Given some
FakeTensors inputs (dummy Tensors that don't have storage), this function returns
dummy Tensors with the correct Tensor metadata(shape/strides/dtype/device). This is
used by torch.compile to infer the shape and other metadata of the output tensors.</p>
<p>Reference: https://pytorch.org/tutorials/advanced/python_custom_ops.html#python-custom-ops-tutorial</p>
<p><a id="torchmx.mx_tensor.ToMXConstrFunc"></a></p>
<h2 id="tomxconstrfunc-objects">ToMXConstrFunc Objects</h2>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L197">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">allow_in_graph</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">ToMXConstrFunc</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">Function</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Differentiable cast to MX, no-op in backward</p>
<p><a id="torchmx.mx_tensor.ToMXConstrFunc.forward"></a></p>
<h4 id="forward">forward</h4>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L203">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">data_hp</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">elem_dtype</span><span class="p">:</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>            <span class="n">block_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Forward method for the custom autograd function.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>ctx</code> - The context object that can be used to stash information
  for backward computation.</li>
<li><code>data_hp</code> <em>torch.Tensor</em> - The high-precision input tensor to be quantized.</li>
<li><code>elem_dtype</code> <em>dtypes.DType</em> - The target data type for quantization.</li>
<li><code>block_size</code> <em>int</em> - The block size used for quantization.</li>
<li><code>padding</code> <em>int</em> - The padding size applied during quantization.</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>MXTensor</code> - A custom tensor object containing the quantized data,
  scale factor, and metadata about the quantization process.</li>
</ul>
<p><a id="torchmx.mx_tensor.FromMXConstrFunc"></a></p>
<h2 id="frommxconstrfunc-objects">FromMXConstrFunc Objects</h2>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L256">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">allow_in_graph</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">FromMXConstrFunc</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">Function</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Differentiable cast from MX, no-op in backward</p>
<p><a id="torchmx.mx_tensor.FromMXConstrFunc.forward"></a></p>
<h4 id="forward_1">forward</h4>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L262">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">tensor_lp</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>            <span class="n">target_dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>
<p>Forward method for dequantizing a low-precision tensor to a target data type.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>ctx</code> - The context object (not used in this implementation).</li>
<li><code>tensor_lp</code> <em>torch.Tensor</em> - The low-precision tensor to be dequantized.
  This tensor is expected to have the following attributes:</li>
<li>_data: The raw data of the tensor.</li>
<li>_scale_e8m0: The scale factor for dequantization.</li>
<li>_elem_dtype.name: The name of the element data type.</li>
<li>_block_size: The block size used in the tensor.</li>
<li>_block_dim: The block dimensions of the tensor.</li>
<li>_padding: The amount of padding applied to the tensor.</li>
<li><code>target_dtype</code> <em>torch.dtype</em> - The target data type to which the tensor
  should be dequantized.</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>torch.Tensor</code> - The dequantized tensor, reshaped to its original shape
  if padding was involved.</li>
</ul>
<p><a id="torchmx.mx_tensor.NoopFwToMXBw"></a></p>
<h2 id="noopfwtomxbw-objects">NoopFwToMXBw Objects</h2>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L335">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">allow_in_graph</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">NoopFwToMXBw</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">Function</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Forward: no-op
Backward: cast grad to MX</p>
<p><a id="torchmx.mx_tensor.MXTensor"></a></p>
<h2 id="mxtensor-objects">MXTensor Objects</h2>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L357">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MXTensor</span><span class="p">(</span><span class="n">TorchAOBaseTensor</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><a id="torchmx.mx_tensor.MXTensor.__new__"></a></p>
<h4 id="__new__">__new__</h4>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L358">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span>
<span class="normal"><a href="#__codelineno-10-6">6</a></span>
<span class="normal"><a href="#__codelineno-10-7">7</a></span>
<span class="normal"><a href="#__codelineno-10-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>            <span class="n">scale_e8m0_bits</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>            <span class="n">data_bits</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a>            <span class="n">elem_dtype</span><span class="p">:</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a>            <span class="n">block_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a>            <span class="n">orig_dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a>            <span class="n">padding</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a>            <span class="n">block_dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Create a new instance of the tensor subclass.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>cls</code> - The class being instantiated.</li>
<li><code>scale_e8m0_bits</code> <em>torch.Tensor</em> - A tensor containing scale factors with dtype torch.uint8.</li>
<li><code>data_bits</code> <em>torch.Tensor</em> - A tensor containing data bits.</li>
<li><code>elem_dtype</code> <em>dtypes.DType</em> - The element data type.</li>
<li><code>block_size</code> <em>int</em> - The block size.</li>
<li><code>orig_dtype</code> <em>torch.dtype</em> - The original data type.</li>
<li><code>block_dim</code> <em>int</em> - The block dimension. Default is None. If not set it defaults to the
  last dimension.</li>
<li><code>padding</code> <em>int</em> - Padding size in case the block_dim is not multiple of the block_size
  Default is 0.</li>
</ul>
<p><strong>Returns</strong>:</p>
<p>An instance of the tensor subclass.</p>
<p><strong>Raises</strong>:</p>
<ul>
<li><code>AssertionError</code> - If the dtype of scale_e8m0_bits is not torch.uint8.</li>
<li><code>AssertionError</code> - If the shape of scale_e8m0_bits is not 1-dimensional.</li>
<li><code>AssertionError</code> - If the dtype of data_bits is not one of the supported types.</li>
<li><code>AssertionError</code> - If elem_dtype is unsupported.</li>
</ul>
<p><a id="torchmx.mx_tensor.MXTensor.to_dtype"></a></p>
<h4 id="to_dtype">to_dtype</h4>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L456">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_dtype</span><span class="p">(</span><span class="n">target_dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>
<p>Dequantize the MXTensor to the target_dtype.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>target_dtype</code> <em>torch.dtype</em> - The target data type                 (torch.bfloat16, torch.float32, etc.)                 to which the MXTensor is dequantized.</li>
</ul>
<p><strong>Returns</strong>:</p>
<p>The dequantized tensor in the target_dtype.</p>
<p><strong>Notes</strong>:</p>
<p>The MXTensor quantization is supported only for <code>torch.bfloat16</code>. But we             allow the dequantization to either <code>torch.bfloat16</code> or <code>torch.float32</code>.
  Look at the <code>quantize_mx</code> and <code>de_quantize_mx</code> functions for more details.</p>
<p><a id="torchmx.mx_tensor.MXTensor.to_mx"></a></p>
<h4 id="to_mx">to_mx</h4>
<p><span style="float: right; font-size: 90%;">
<a href="https://github.com/rain-neuromorphics/torchmx/blob/abhijit/add-contrib/docs/../torchmx/mx_tensor.py#L476">[view source]</a>
</span></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">allow_in_graph</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_mx</span><span class="p">(</span><span class="n">data_hp</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a>          <span class="n">elem_dtype</span><span class="p">:</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a>          <span class="n">block_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MXTensor&quot;</span>
</code></pre></div></td></tr></table></div>
<p>Convert/Quantize a high-precision tensor to MXTensor.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>data_hp</code> <em>torch.Tensor</em> - The high-precision input tensor.                   Only <code>torch.bfloat16</code> is supported. Look at the <code>quantize_mx</code>                   function for more details.</li>
<li><code>elem_dtype</code> <em>dtypes.DType</em> - The target element data type for quantization.</li>
<li><code>block_size</code> <em>int</em> - The block size. Default is 32.</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>MXTensor</code> - The quantized tensor in the target lower precision format.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>